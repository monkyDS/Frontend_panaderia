<!-- Content Header (Page header) -->
<div class="content-header">
    <div class="container-fluid">
        <div class="row mb-2">
            <div class="col-sm-6">
              <h1 class="m-0">Ventas</h1>
            </div><!--col-->
            <!--<div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                    <li class="breadcrumb-item"><a href="#">Home/</a></li>
                </ol>
            </div>--><!--col-->
        </div><!-- /.row -->
    </div><!-- /.container-fluid -->
</div>
<!-- /.content-header -->
<!-- Main content -->
<section class="content">
    <div class="container-fluid">
        <!--CONTENIDO-->
      <hr>
      <input type="button" value="Crear Nueva Venta" class="btn-warning" (click)="mostrar_form('ver')">
      <hr>
      <!--FORMULARIO-->
    <div id="formulario" *ngIf="mform == true">
        <div class="row">
            <div class="col-lg-4">
                <input type="date" class="form-control" id="date" name="date" [(ngModel)]="obj_ventas.fecha">
                <span style="color: red;" *ngIf="Validar_fecha == false" >Insertar fecha de la venta</span>
            </div>
            <div class="col-lg-4">
                <select class="form-control form-select" [(ngModel)]="obj_ventas.fo_usuario">
                    <option value="0" label="seleccione usuario" selected="selected">Seleccione el usuario</option>
                    <option *ngFor="let itemusu of usuarios" value="{{itemusu.id_usuario}}">{{itemusu.nombre}}</option>
                </select>
                <span style="color: red;" *ngIf="Validar_fo_usuario === false">Seleccionar el usuario</span>
            </div>
            <div class="col-lg-4">
                <select class="form-control form-select" [(ngModel)]="obj_ventas.fo_cliente">
                    <option value="0" label="seleccione el cliente" selected="selected">Seleccione el cliente</option>
                    <option *ngFor="let itemcli of cliente" value="{{itemcli.id_cliente}}">{{itemcli.nombre}}</option>
                </select>
                <span style="color: red;" *ngIf="Validar_fo_cliente === false">Seleccionar el cliente</span>
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-lg-4">
                <select class="form-control form-select" [(ngModel)]="obj_ventas.fo_productos">
                    <option value="0" label="seleccione producto" selected="selected">Seleccione el producto</option>
                    <option *ngFor="let itemp of productos" value="{{itemp.id_productos}}">{{itemp.nombre}}</option>
                </select>
                <span style="color: red;" *ngIf="Validar_fo_productos === false">Seleccionar el producto</span>
            </div>
            <div class="col-lg-4">
                <select class="form-control form-select" [(ngModel)]="obj_ventas.fo_proveedor">
                    <option value="0" label="seleccione proveedor" selected="selected">Seleccione el proveedor</option>
                    <option *ngFor="let itempro of proveedor" value="{{itempro.id_proveedor}}">{{itempro.razon_social}}</option>
                </select>
                <span style="color: red;" *ngIf="Validar_fo_proveedor === false">Seleccionar un proveedor</span>
            </div>
            <div class="col-lg-4">
                <input type="text" class="form-control" placeholder="Cantidad Producto" 
                [(ngModel)]="obj_ventas.cantidad">
                <span style="color: red;" *ngIf="Validar_cantidad == false">Insertar la cantidad del producto</span>
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-lg-4">
                <input type="text" class="form-control" placeholder="Precio" 
                [(ngModel)]="obj_ventas.precios">
                <span style="color: red;" *ngIf="Validar_precios == false">Insertar el precio del producto</span>
            </div>
            <div class="col-lg-4">
                <input type="text" class="form-control" placeholder="Iva" 
                [(ngModel)]="obj_ventas.iva">
                <span style="color: red;" *ngIf="Validar_iva == false">Insertar el iva del producto</span>
            </div>
            <div class="col-lg-4">
                <input type="text" class="form-control" placeholder="Subtotal" 
                [(ngModel)]="obj_ventas.subtotales">
                <span style="color: red;" *ngIf="Validar_total == false">Insertar el subtotal del producto</span>
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-lg-4">
                <input type="text" class="form-control" placeholder="Total" 
                [(ngModel)]="obj_ventas.total">
                <span style="color: red;" *ngIf="Validar_total == false">Insertar el total del producto</span>
            </div>
            <div class="col-lg-4">
                <input type="button" value="Guardar" class="btn btn-primary" style="width: 100%;" (click)="validar('guardar')" *ngIf="botones_form == false">
                <input type="button" value="Editar" class="btn btn-primary" style="width: 100%;" (click)="validar('editar')" *ngIf="botones_form == true">
            </div>
            <div class="col-lg-4">
                <input type="button" value="Cancelar" class="btn btn-secondary" style="width: 100%;" (click)="mostrar_form('no ver')">
            </div>
        </div>
    </div>
      <!--Tabla-->
      <hr>
      <div style="background-color: rgb(94, 53, 53);" id="tabla">
        <div class="row">
            <!--<div class="col-lg-1"></div>-->
            <div class="col-lg-12">
                <div class="table-responsive">
                    <table class="table">
                        <tr class="heading">
                          <th>Fecha</th>
                          <th>Usuario</th>
                          <th>Cliente</th> 
                          <th>Productos</th>
                          <th>Proveedor</th>
                          <th>Cantidad</th>
                          <th>Precio</th>
                          <th>Iva</th>
                          <th>Subtotal</th>
                          <th>Total</th>
                          <th>Acciones</th>
                        </tr>
                        <tr *ngFor="let item of ventas">
                          <td>{{item.fecha}}</td>
                          <td>{{item.usuarios}}</td>
                          <td>{{item.cliente}}</td>
                          <td>{{item.productos}}</td>
                          <td>{{item.proveedor}}</td>
                          <td>{{item.cantidad}}</td>
                          <td>{{item.precios | currency}}</td>
                          <td>{{item.iva}}</td>
                          <td>{{item.subtotales}}</td>
                          <td>{{item.total | currency}}</td>
                          <td>
                            <span class="fas fa-edit" style="color: rgb(26, 8, 130); cursor: pointer;" title="Editar" (click)="cargar_datos(item, item.id_ventas)"></span> 
                            / 
                            <span class="fas fa-file-archive" style="color: rgb(132, 255, 0); cursor: pointer;" title="Imprimir" (click)="imprimir(item.id_ventas)"></span>
                            /
                            <span class="fas fa-backspace" style="color: rgb(255, 0, 0); cursor: pointer;" title="Eliminar" (click)="eliminar(item.id_ventas)"></span>
                          </td>
                        </tr>
                    </table>
                </div>
            </div>
            <!--<div class="col-lg-1"></div>-->
        </div>
      </div>
    </div>
<!--IMPRIMIR FACTURA-->
<div class="invoice-container" id="invoice-container">
    <div class="invoice-box">
        <table cellpadding="0" cellspacing="0">
            <tr class="top">
                <td colspan="5">
                    <table>
                        <tr>
                            <td class="title">
                                <h1>Factura</h1>
                            </td>
                            <td>
                                Número de factura: <span id="invoice-number-display"></span><br>
                                Fecha: <span id="date-display"></span><br>
                                Vencimiento: <span id="due-date-display"></span>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr class="information">
                <td colspan="5">
                    <table>
                        <tr>
                            <td>
                                <span id="company-name-display"></span><br>
                                <span id="company-address-display"></span>
                            </td>
                            <td>
                                <p>Cliente: <span id="client-name-display"></span></p>
                                <span id="client-address-display"></span>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr class="heading">
                <td>Producto</td>
                <td>Marca</td>
                <td>Proveedor</td>
                <td>Cantidad</td>
                <td>Precio (COP)</td>
            </tr>
            <tr class="item">
                <td><span id="product-1-display"></span></td>
                <td><span id="brand-1-display"></span></td>
                <td><span id="provider-1-display"></span></td>
                <td><span id="quantity-1-display"></span></td>
                <td><span id="price-1-display"></span></td>
            </tr>
            <!-- Agrega más filas si es necesario -->
            <tr class="total">
                <td colspan="3"></td>
                <td>Subtotal:</td>
                <td><span id="subtotal-display"></span> COP</td>
            </tr>
            <tr class="total">
                <td colspan="3"></td>
                <td>IVA (19%):</td>
                <td><span id="iva-display"></span> COP</td>
            </tr>
            <tr class="total">
                <td colspan="3"></td>
                <td>Total:</td>
                <td><span id="total-display"></span> COP</td>
            </tr>
        </table>
        <div class="seller-info">
            <p>Vendedor: <span id="seller-display"></span></p>
        </div>
        <div class="buttons">
            <button (click)="printInvoice()">Imprimir</button>
            <button (click)="cancelInvoice()">Cancelar</button>
        </div>
    </div>
</div>
</section>
<!-- /.content -->
